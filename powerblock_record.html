<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { 
  getFirestore, 
  collection, 
  getDocs, 
  deleteDoc, 
  doc, 
  query, 
  orderBy 
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// üî¥ PASTE YOUR FIREBASE CONFIG HERE
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const container = document.getElementById("recordContainer");

async function loadRecords() {
  container.innerHTML = "";

  const q = query(collection(db, "powerBlockRecords"), orderBy("createdAt", "desc"));
  const snapshot = await getDocs(q);

  if (snapshot.empty) {
    container.innerHTML = "<p class='no-data'>No Power Block Records Found</p>";
    return;
  }

  snapshot.forEach((documentData, index) => {
    const rec = documentData.data();
    const id = documentData.id;

    const card = document.createElement("div");
    card.className = "record-card";

    card.innerHTML = `
      <h3>Power Block Request #${index + 1}</h3>
      <div class="item"><span>Applicant Name:</span> ${rec.applicant || ""}</div>
      <div class="item"><span>From ‚Äì To:</span> ${rec.from || ""} ‚Üí ${rec.to || ""}</div>
      <div class="item"><span>Reason:</span> ${rec.reason || ""}</div>
      <div class="item"><span>Date & Time:</span> ${rec.datetime || ""}</div>
      <button class="delete-btn" data-id="${id}">Delete Record</button>
    `;

    container.appendChild(card);
  });

  // Attach delete event
  document.querySelectorAll(".delete-btn").forEach(btn => {
    btn.addEventListener("click", async function() {
      const recordId = this.getAttribute("data-id");
      if (!confirm("Are you sure you want to delete this record?")) return;

      await deleteDoc(doc(db, "powerBlockRecords", recordId));
      alert("üóëÔ∏è Record Deleted Successfully");
      loadRecords();
    });
  });
}

loadRecords();
</script>
